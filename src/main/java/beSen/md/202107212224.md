笔记：记录上传资料的逻辑
日期：2021年7月21日
天气：晴天

活动类型 文档类型 版本 模板名称 状态 驳回原因 附件 生效日期 失效日期 更新时间

t1表(活动类型 文档类型) 

t2表(版本 附件 生效日期 失效日期) 其中一个字段 t2_type_id 关联 t1表的主键 t1_id

t2表(模板名称)

t3表(状态 驳回原因 更新时间)

一、查询
展示驳回原因 
                                        

二、用户上传附件的时候 根据关联的ID判断是否存在附件 
如果不存在历史附件 则 1.插入附件 t2 表 (记录版本号)2.插入t3 表 a.状态：uploaded 已上传 b.更新时间：当前时间
如果存在历史附件并且attributes6不是reject 则 1.删除历史附件 t2 表 (把 isDeleted 设置为Y) 插入新的附件(把 isDeleted 设置为N 版本号+1 ) 2.更新t3表 a.更新时间 
如果存在历史附件并且attributes6是reject 则插入新的附件


三、用户驳回的时候 

如果没有附件 前端控制不让驳回
如果存在附件 驳回的时候 1.删除历史附件 (把 isDeleted 设置为Y) attributes6 更新reject 2.更新 t3 表 a.状态：reject 驳回 b.驳回原因 c.更新时间


四、查询历史附件 
查询 isDeleted 是 Y 的数据
uploaded 转义为 TQC 覆盖



